<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Trhoncal Homes | Mirador del Bosque – Zapopan</title>
  <meta name="description" content="Mirador del Bosque en Zapopan. Prototipos Nardo y Oliva desde $726,000. Puede ser tuyo sin enganche. Acompañamiento total en tu crédito."/>
  <link rel="canonical" href="https://mirador.3dhomes.com.mx/"/>

  <!-- OG/Twitter preview -->
  <meta property="og:title" content="Mirador del Bosque | Puede ser tuyo sin enganche"/>
  <meta property="og:description" content="Hogar en Zapopan desde $726,000. Últimas unidades sin enganche. Agenda tu visita."/>
  <meta property="og:image" content="https://mirador.3dhomes.com.mx/assets/hero-1600.jpg"/>
  <meta property="og:type" content="website"/>
  <meta name="twitter:card" content="summary_large_image"/>

  <!-- Favicons (opcional si ya los tienes) -->
  <link rel="icon" href="/assets/favicon.ico"/>
  <link rel="apple-touch-icon" href="/assets/icon-180.png"/>

  <style>
    :root{--gold:#C9A227;--dark:#0f172a;--muted:#475569;--light:#f8fafc;--wa:#25D366;--border:#e2e8f0}
    *{box-sizing:border-box}
    body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;color:var(--dark);background:#fff}
    a{color:inherit;text-decoration:none}
    img{max-width:100%;display:block}
    .container{max-width:1100px;margin:0 auto;padding:0 20px}
    .btn{display:inline-block;padding:12px 18px;border-radius:999px;border:1px solid var(--gold);font-weight:700}
    .btn.primary{background:var(--gold);color:#fff}
    .btn.ghost{background:transparent;color:var(--gold)}
    .btn.whatsapp{background:var(--wa);border-color:var(--wa);color:#fff}
    header{position:sticky;top:0;z-index:50;background:rgba(255,255,255,.95);backdrop-filter:saturate(180%) blur(8px);border-bottom:1px solid var(--border)}
    header .wrap{display:flex;align-items:center;justify-content:space-between;height:72px}
    nav a{margin-left:18px;color:var(--muted)}
    .logo-img{height:92px}
    @media(max-width:768px){header nav{display:none} header .wrap{justify-content:center}}
    .breadcrumb{font-size:14px;color:var(--muted);padding:10px 0}

    .hero{position:relative;min-height:360px;display:grid;align-items:end;padding:28px 0;color:#fff}
    .hero-video{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;z-index:-2}
.hero .overlay{position:absolute;inset:0;background:linear-gradient(180deg,rgba(0,0,0,.35),rgba(0,0,0,.55));z-index:-1}
    .hero h1{margin:0 0 10px;font-size:clamp(28px,5vw,46px);line-height:1.1}
    .hero p{margin:0 0 16px;color:#e5e7eb}
    .badges{display:flex;flex-wrap:wrap;gap:10px;margin:10px 0 22px}
    .badge{padding:8px 12px;border:1px solid var(--border);border-radius:999px;background:rgba(255,255,255,.9);color:#111}
    .promo{margin:8px 0 16px;display:inline-block;background:#fff;color:#111;padding:8px 12px;border-radius:999px;font-weight:800;border:2px solid var(--gold)}
    .cta-bar{display:flex;gap:10px;flex-wrap:wrap}

    .section{padding:42px 0}
    .grid{display:grid;gap:16px}
    @media(min-width:900px){.grid.cols-2{grid-template-columns:1fr 1fr}}

    .cards{display:grid;grid-template-columns:repeat(12,1fr);gap:18px}
    .card{grid-column:span 12;background:#fff;border:1px solid var(--border);border-radius:16px;overflow:hidden;box-shadow:0 8px 22px rgba(0,0,0,.04)}
    .card img{width:100%;height:220px;object-fit:cover;background:#e2e8f0}
    .card .p{padding:14px}
    .card h3{margin:0 0 6px;font-size:18px}
    .meta{color:var(--muted);font-size:14px;margin-bottom:10px}
    @media(min-width:700px){.card{grid-column:span 6}} @media(min-width:1000px){.card{grid-column:span 4}}

    .icon-list{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}
    @media(min-width:700px){.icon-list{grid-template-columns:repeat(3,1fr)}}
    .icon-item{display:flex;align-items:center;gap:10px;border:1px solid var(--border);border-radius:12px;padding:10px;background:#fff}

    /* Thumbs por modelo */
    .thumbs{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin:10px 0 0}
    .thumbs img{height:62px;object-fit:cover;border-radius:8px;border:1px solid var(--border);cursor:pointer;transition:transform .15s}
    .thumbs img:hover{transform:scale(1.02)}

    .toast{position:fixed;left:50%;bottom:18px;transform:translateX(-50%);background:#0f172a;color:#fff;padding:10px 14px;border-radius:10px;box-shadow:0 8px 22px rgba(0,0,0,.25);display:none;z-index:70}
    .sticky-cta{position:sticky;bottom:0;background:#fff;border-top:1px solid var(--border);padding:10px;display:flex;gap:10px;justify-content:center}
    .is-hidden{display:none!important}

    /* Faja de oferta */
    .deal{background:#0f172a;color:#fff}
    .deal .wrap{display:flex;gap:14px;align-items:center;justify-content:space-between;padding:16px 0}
    .deal strong{font-size:clamp(16px,3.2vw,22px)}

    /* Lightbox modal */
    .lightbox{position:fixed;inset:0;background:rgba(0,0,0,.85);display:none;align-items:center;justify-content:center;z-index:80;padding:20px}
    .lightbox img{max-width:min(100%,900px);max-height:80vh;border-radius:12px}
    .lightbox .controls{position:absolute;inset:0;display:flex;align-items:center;justify-content:space-between;padding:20px}
    .lightbox button{background:rgba(255,255,255,.1);border:1px solid #fff;color:#fff;border-radius:999px;padding:8px 12px;font-weight:700}
    .lightbox .close{position:absolute;top:14px;right:14px}
  
/** ===== Amenidades limpias v2 ===== (ajustado) **/
/* ===== Punch horizontal ===== */
.amenities-punch{display:flex;flex-direction:row;align-items:center;gap:20px;border:1px solid var(--gold);border-radius:14px;padding:16px;background:#fff;color:var(--dark);margin:20px 0}
.amenities-punch h3{margin:0;font-size:18px;flex:0 0 auto;color:var(--dark)}
.amenities-punch ul{margin:0;flex:1;list-style:disc;padding-left:18px}
.amenities-punch li{margin-bottom:6px}
.amenities-punch .btn{flex:0 0 auto}

  
/* ===== Ajustes v4 ===== */
.amenity .icon{font-size:34px;line-height:1;margin-top:2px;flex:0 0 auto}
.amenities-punch{display:flex;flex-direction:row;align-items:center;gap:22px;border:1px solid var(--gold);border-radius:14px;padding:18px;background:#fff;color:var(--dark);margin:16px 0}
.amenities-punch h3{margin:0;font-size:20px;color:var(--dark);flex:0 0 auto;white-space:nowrap}
.amenities-punch ul{margin:0;flex:1;list-style:disc;padding-left:20px}
.amenities-punch li{margin-bottom:6px}
.amenities-punch .btn{flex:0 0 auto}
@media(max-width:720px){
  .amenities-punch{flex-direction:column;align-items:flex-start}
  .amenities-punch h3{white-space:normal}
}

  
/* ===== Punch con bullets icónicos ===== */
.amenities-punch{display:flex;flex-direction:row;align-items:center;gap:22px;border:1px solid var(--gold);border-radius:14px;padding:18px;background:#fff;color:var(--dark);margin:16px 0}
.amenities-punch h3{margin:0 12px 0 0;font-size:20px;color:var(--dark);flex:0 0 auto;white-space:nowrap}
.punch-list{margin:0;flex:1;display:flex;flex-direction:column;gap:10px;padding:0}
.punch-list li{list-style:none;display:flex;gap:10px;align-items:flex-start}
.punch-list .bicon{font-size:22px;line-height:1.1;margin-top:2px;flex:0 0 auto}
.punch-list span{color:var(--dark)}
@media(max-width:720px){
  .amenities-punch{flex-direction:column;align-items:flex-start}
  .amenities-punch h3{white-space:normal;margin:0 0 6px 0}
}

  
/* ===== Recuadro dorado — texto horizontal ===== */
.amenities-punch{display:block;border:1px solid var(--gold);border-radius:14px;padding:20px;background:#fff;color:var(--dark);margin:18px 0}
.amenities-punch h3{margin:0 0 12px 0;font-size:20px;color:var(--dark)}
.punch-list{margin:0;padding:0;display:flex;flex-direction:column;gap:14px}
.punch-list li{list-style:none;display:flex;align-items:flex-start;gap:12px}
.punch-list .bicon{font-size:24px;line-height:1.1;margin-top:2px;flex:0 0 auto}
.punch-list span{font-size:16px;line-height:1.35;color:var(--dark)}
.amenities-punch .btn{margin-top:14px}
@media(min-width:900px){
  .punch-list span{font-size:17px}
}

  
/* ===== Recuadro dorado final ===== */
.amenities-punch{border:1px solid var(--gold);border-radius:14px;padding:22px;background:#fff;color:var(--dark);margin:20px 0;display:flex;flex-direction:column;gap:16px}
.amenities-punch h3{margin:0;font-size:20px;font-weight:700;color:var(--dark)}
.punch-list{margin:0;padding:0;display:flex;flex-direction:column;gap:12px}
.punch-list li{list-style:none;display:flex;align-items:flex-start;gap:12px}
.punch-list span{font-size:16px;line-height:1.4;color:var(--dark)}
.punch-list .bicon{font-size:22px;line-height:1.2;margin-top:2px}
.amenities-punch .btn{align-self:flex-start;margin-top:10px}
@media(min-width:900px){
  .punch-list span{font-size:17px}
}

  
/* ===== Ajuste final estilo segun mock ===== */
/* Caja dorada */
.amenities-punch{
  border:1px solid var(--gold);
  border-radius:14px;
  padding:18px 18px 16px 18px;
  background:#fff;
  color:var(--dark);
  margin:16px 0;
  display:flex;
  flex-direction:column;
  gap:14px;
}
.amenities-punch h3{
  margin:0;
  text-align:center;
  font-size:18px;
  font-weight:800;
}
.punch-list{margin:0;padding:0;display:flex;flex-direction:column;gap:10px}
.punch-list li{list-style:none;display:flex;gap:10px;align-items:flex-start}
.punch-list .bicon{font-size:18px;line-height:1.1;margin-top:2px;flex:0 0 auto}
.punch-list span{color:var(--dark)}

/* Amenidades columna derecha en una sola columna, sin tarjetas */
.amenities-grid{display:grid;grid-template-columns:1fr;gap:16px}
.amenity{
  display:flex;
  gap:10px;
  align-items:flex-start;
  border:none;
  background:transparent;
  padding:0;
  min-height:auto;
  border-radius:0;
}
.amenity .icon{font-size:22px;line-height:1;margin-top:2px;flex:0 0 auto}
.amenity .title{font-weight:800;margin:0 0 2px 0}
.amenity p{margin:0;color:var(--dark)}

  
/* ===== Ajustes solo para móvil v9 ===== */
@media (max-width: 600px) {
  .amenities-punch {
    padding: 22px;
    gap: 20px;
  }
  .amenities-punch h3 {
    font-size: 22px;
    text-align: center;
  }
  .punch-list li {
    gap: 16px;
  }
  .punch-list span {
    font-size: 18px;
    line-height: 1.5;
  }
  .amenities-punch .btn {
    font-size: 16px;
    padding: 12px 22px;
    align-self: center;
  }
  .amenity .icon {
    font-size: 28px;
  }
  .amenity .title {
    font-size: 18px;
  }
  .amenity p {
    font-size: 16px;
    line-height: 1.5;
  }
}

  
/* === Ajuste de video en desktop (más alto y foco a edificios) === */
@media (min-width: 1024px) {
  .hero { min-height: 80vh; }
  .hero-video { object-position: 60% 50%; }
}

  </style>
</head>
<body>
  <header>
    <div class="container wrap">
      <div class="logo"><img class="logo-img" src="assets/logo-trhoncal-flat.png" alt="Trhoncal Homes" loading="lazy"/></div>
      <nav><a href="/">Inicio</a><a href="/catalogo-devs.html">Desarrollos</a><a href="#contacto">Contacto</a></nav>
    </div>
  </header>

  <main>
    <div class="container breadcrumb">Inicio ▸ Desarrollos ▸ <strong>Mirador del Bosque</strong></div>

    <section class="hero">
  <video autoplay muted loop playsinline class="hero-video">
    <source src="assets/Video mirador del bosque.mp4" type="video/mp4">
  </video>
  <div class="overlay"></div>
      <div class="container">
        <span class="promo">Últimas unidades sin enganche</span>
        <h1>Mirador del Bosque</h1>
        <p><strong>Puede ser tuyo sin enganche.</strong> Tu hogar al norte de Zapopan: ubicación estratégica y bienestar diario. Desde <strong>$726,000</strong>.</p>

        <div class="badges">
          <div class="badge">Ubicación: Zapopan</div>
          <div class="badge">Desde <strong>$726,000</strong></div>
          <div class="badge">2 recámaras y 2 recámaras opcion alcoba</div>
        </div>

        <div class="cta-bar">
          <a class="btn primary" href="#contacto">Solicitar información</a>
          <a class="btn ghost ask-fill" href="#">Solicitar ficha</a>
        </div>
        <p class="meta" style="margin-top:10px;color:#e5e7eb">*Sujeto a disponibilidad.</p>
      </div>
    </section>

    <section class="deal">
      <div class="container wrap">
        <strong>Últimas unidades <span style="color:#C9A227">sin enganche</span>.</strong>
        <a class="btn primary" href="#contacto">Agenda tu visita</a>
      </div>
    </section>

    <section class="section">
      <div class="container grid cols-2">
        <div>
          <h2>Resumen</h2>
          <p class="meta">
            Elige vivir donde la tranquilidad se siente todos los días. <strong>Nardo</strong> y <strong>Oliva</strong> combinan diseño inteligente, luz natural y espacios para crear recuerdos. Te acompañamos <strong>de principio a fin</strong> con tu crédito (Infonavit, Fovissste, bancario o mixto). <strong>Sin enganche.</strong> Agenda tu visita y asegura una de las últimas ubicaciones.
          
</p>
<aside class="amenities-punch">
<h3>Vivir aquí se siente mejor</h3>
<ul class="punch-list">
  <li>
    <span class="bicon">⏱️</span>
    <span><strong>Más tiempo para tu familia</strong>, menos traslados.</span>
  </li>
  <li>
    <span class="bicon">🧘</span>
    <span><strong>Áreas pensadas para tu día a día</strong>: ejercicio, descanso y juego.</span>
  </li>
  <li>
    <span class="bicon">📈</span>
    <span><strong>Plusvalía al norte de Zapopan</strong> y <strong>opción sin enganche</strong>.</span>
  </li>
</ul>
<a class="btn primary" href="#contacto">Quiero más información</a>
</aside>
        </div>
        <div>
          <h2>Amenidades</h2>

<div class="amenities-wrap">
  <div class="amenities-grid">
    <div class="amenity"><div class="icon">🌇</div><div><div class="title"><strong>Terraza de usos múltiples</strong></div><p>Espacio perfecto para reuniones, eventos y convivencias familiares.</p></div></div>
    <div class="amenity"><div class="icon">🏋️</div><div><div class="title"><strong>Gimnasio al aire libre</strong></div><p>Ejercítate todos los días sin salir del desarrollo.</p></div></div>
    <div class="amenity"><div class="icon">👨‍👩‍👧</div><div><div class="title"><strong>Juegos infantiles</strong></div><p>Diversión segura y cerca de casa para los pequeños.</p></div></div>
    <div class="amenity"><div class="icon">🌿</div><div><div class="title"><strong>Pergolados</strong></div><p>Áreas sombreadas para descansar, leer o trabajar.</p></div></div>
    <div class="amenity"><div class="icon">🏃‍♂️</div><div><div class="title"><strong>Pista de jogging</strong></div><p>Corre o camina con tranquilidad dentro del coto.</p></div></div>
    <div class="amenity"><div class="icon">🌄</div><div><div class="title"><strong>Mirador panorámico</strong></div><p>Vistas espectaculares para disfrutar cada tarde.</p></div></div>
    <div class="amenity"><div class="icon">📚</div><div><div class="title"><strong>Escuela</strong></div><p>Educación a minutos de tu hogar para mayor comodidad.</p></div></div>
    <div class="amenity"><div class="icon">🛒</div><div><div class="title"><strong>Zona comercial</strong></div><p>Todo lo esencial cerca: compras, servicios y antojos.</p></div></div>
  </div>
  
</div>
<p class="meta" style="margin-top:8px">*Amenidades sujetas a cambios por etapa y disponibilidad.</p>

        </div>
      </div>
    </section>

    <section id="modelos" class="section">
      <div class="container">
        <h2>Prototipos</h2>
        <div class="cards">
          <!-- NARDO -->
          <article class="card">
            <img id="img-nardo" src="assets/nardo.jpg" alt="Nardo" loading="lazy"/>
            <div class="p">
              <h3>Nardo</h3>
              <div class="meta">2 recámaras</div>
              <div style="display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap">
                <span>Desde <strong>$726,000</strong></span>
                <div style="display:flex;gap:8px;flex-wrap:wrap">
                  <a class="btn ghost gallery-btn" href="#" data-gallery="nardo">Ver fotos</a>
                  <a class="btn ask-fill" href="#">Solicitar ficha</a>
                </div>
              </div>
              <div class="thumbs">
                <img data-target="img-nardo" data-src="assets/nardo.jpg"  src="assets/nardo.jpg"  alt="Nardo portada" loading="lazy"/>
                <img data-target="img-nardo" data-src="assets/nardo-2.jpg" src="assets/nardo-2.jpg" alt="Nardo 2" loading="lazy"/>
                <img data-target="img-nardo" data-src="assets/nardo-3.jpg" src="assets/nardo-3.jpg" alt="Nardo 3" loading="lazy"/>
                <img data-target="img-nardo" data-src="assets/nardo-4.jpg" src="assets/nardo-4.jpg" alt="Nardo 4" loading="lazy"/>
              </div>
              <!-- Lista para lightbox -->
              <ul class="is-hidden" id="gallery-nardo">
                <li>assets/nardo.jpg</li>
                <li>assets/nardo-2.jpg</li>
                <li>assets/nardo-3.jpg</li>
                <li>assets/nardo-4.jpg</li>
              </ul>
            </div>
          </article>

          <!-- OLIVA -->
          <article class="card">
            <img id="img-oliva" src="assets/oliva.jpg" alt="Oliva" loading="lazy"/>
            <div class="p">
              <h3>Oliva</h3>
              <div class="meta">2 recámaras con opcion alcoba </div>
              <div style="display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap">
                <span>Desde <strong>$786,000</strong></span>
                <div style="display:flex;gap:8px;flex-wrap:wrap">
                  <a class="btn ghost gallery-btn" href="#" data-gallery="oliva">Ver fotos</a>
                  <a class="btn ask-fill" href="#">Solicitar ficha</a>
                </div>
              </div>
              <div class="thumbs">
                <img data-target="img-oliva" data-src="assets/oliva.jpg"  src="assets/oliva.jpg"  alt="Oliva portada" loading="lazy"/>
                <img data-target="img-oliva" data-src="assets/oliva-2.jpg" src="assets/oliva-2.jpg" alt="Oliva 2" loading="lazy"/>
                <img data-target="img-oliva" data-src="assets/oliva-3.jpg" src="assets/oliva-3.jpg" alt="Oliva 3" loading="lazy"/>
                <img data-target="img-oliva" data-src="assets/oliva-4.jpg" src="assets/oliva-4.jpg" alt="Oliva 4" loading="lazy"/>
              </div>
              <!-- Lista para lightbox -->
              <ul class="is-hidden" id="gallery-oliva">
                <li>assets/oliva.jpg</li>
                <li>assets/oliva-2.jpg</li>
                <li>assets/oliva-3.jpg</li>
                <li>assets/oliva-4.jpg</li>
              </ul>
            </div>
          </article>
        </div>
      </div>
    </section>

    <section id="contacto" class="section" style="border-top:1px solid #e2e8f0">
      <div class="container">
        <h2>Solicita información de Mirador del Bosque</h2>
        <p class="meta">Déjanos tus datos y un asesor te escribe por WhatsApp.</p>

        <form id="lead-form" autocomplete="on">
          <input type="hidden" id="desarrollo" name="desarrollo" value="Mirador del Bosque"/>
          <div class="grid cols-3">
            <div>
              <label for="nombre">Nombre(s)</label>
              <input id="nombre" name="nombre" required placeholder="Tu nombre" autocomplete="given-name"/>
            </div>
            <div>
              <label for="paterno">Apellido paterno</label>
              <input id="paterno" name="paterno" required placeholder="Paterno" autocomplete="additional-name"/>
            </div>
            <div>
              <label for="materno">Apellido materno</label>
              <input id="materno" name="materno" required placeholder="Materno" autocomplete="family-name"/>
            </div>
          </div>

          <div class="grid cols-3" style="margin-top:10px">
            <div>
              <label for="whatsapp">WhatsApp</label>
              <input id="whatsapp" name="whatsapp" required type="tel" inputmode="tel" placeholder="Ej. 33 2933 5952" autocomplete="tel"/>
            </div>
            <div>
              <label for="correo">Correo electrónico</label>
              <input id="correo" name="correo" required type="email" placeholder="tu@correo.com" autocomplete="email"/>
            </div>
            <div>
              <label for="mensaje">Mensaje</label>
              <textarea id="mensaje" name="mensaje" rows="1" placeholder="Cuéntanos qué buscas..."></textarea>
            </div>
          </div>

          <div class="cta-bar" style="margin-top:12px">
            <a id="send-wa" class="btn whatsapp" href="#">Solicitar información por WhatsApp</a>
            <a class="btn ask-fill" href="#">Solicitar ficha</a>
          </div>

          <p id="form-msg" style="margin:10px 0 0;display:none"></p>
        </form>
      </div>
    </section>

    <div class="sticky-cta">
      <a id="sticky-send" class="btn whatsapp is-hidden" href="#">WhatsApp</a>
      <a class="btn ask-fill" href="#">Solicitar ficha</a>
    </div>
  </main>

  <footer>
    <div class="container">
      <div style="display:flex;align-items:center;gap:10px;flex-wrap:wrap;justify-content:space-between">
        <small>© <span id="year"></span> Trhoncal Homes. TR + HON + CAL.</small>
        <small>Privacidad · Términos · Aviso legal</small>
      </div>
    </div>
  </footer>

  <!-- Toast -->
  <div id="toast" class="toast"></div>

  <!-- Lightbox -->
  <div id="lightbox" class="lightbox" aria-hidden="true">
    <div class="controls">
      <button id="prevImg" aria-label="Anterior">◀</button>
      <button id="nextImg" aria-label="Siguiente">▶</button>
    </div>
    <button id="closeLb" class="close" aria-label="Cerrar">✕</button>
    <img id="lbImg" alt="Imagen del prototipo"/>
  </div>

  <script>
    /* ====== CONFIG (no tocar) ====== */
    const WA_DEST  = "523329335952"; // +52 332 933 5952
    const ENDPOINT = "https://script.google.com/macros/s/AKfycbwPuVXGIwLcF-KOPDuOch06KM72fEU0MpZE_xU7NWtFhZb5DqHl4ueeVH7K0bsWtczQtQ/exec";

    document.getElementById('year').textContent = new Date().getFullYear();

    /* ====== Autorrelleno: QP + localStorage ====== */
    (function prefill(){
      const form   = document.getElementById('lead-form');
      const fields = ['nombre','paterno','materno','whatsapp','correo','mensaje'];
      const qp = new URLSearchParams(location.search);

      fields.forEach(f=>{
        const el = form.elements[f];
        if(!el) return;

        const aliases = { correo:['email'], whatsapp:['phone','telefono'] };
        let qv = qp.get(f);
        if(!qv && aliases[f]) { for(const alt of aliases[f]) { qv = qp.get(alt); if(qv) break; } }
        if(qv) el.value = qv;

        if(!el.value){
          const saved = localStorage.getItem('lead_'+f);
          if(saved) el.value = saved;
        }
        el.addEventListener('input',()=>localStorage.setItem('lead_'+f, el.value));
      });
    })();

    /* ====== Helpers ====== */
    function onlyDigits(s){ return (s||"").replace(/\D+/g,''); }
    function fullName(d){ return [d.nombre,d.paterno,d.materno].filter(Boolean).join(' ').trim(); }
    function toast(msg){
      const t = document.getElementById('toast'); t.textContent = msg;
      t.style.display='block'; setTimeout(()=>t.style.display='none', 2600);
    }
    function formDataObject(form){ return Object.fromEntries(new FormData(form).entries()); }
    function utms(){
      const p = new URLSearchParams(location.search);
      return {
        utm_source:  p.get('utm_source')  || '',
        utm_medium:  p.get('utm_medium')  || '',
        utm_campaign:p.get('utm_campaign')|| '',
        utm_term:    p.get('utm_term')    || '',
        utm_content: p.get('utm_content') || ''
      };
    }

    /* ====== WhatsApp ====== */
    function buildMessage(d){
      const telUser = onlyDigits(d.whatsapp)||d.whatsapp;
      return `Hola Trhoncal Homes, me interesa ${d.desarrollo||'el desarrollo'}. ` +
             `Soy ${fullName(d)}. ` +
             `Mi correo es ${d.correo}. ` +
             `Mi WhatsApp es ${telUser}.` +
             (d.mensaje ? ` ${d.mensaje}` : '');
    }
    function goWhatsApp(d){
      const texto = buildMessage(d);
      location.href = `https://wa.me/${WA_DEST}?text=${encodeURIComponent(texto)}`;
window.open(__wa, "_blank", "noopener");

    }

    /* ====== Envío principal ====== */
    async function submitLead(){
      const form = document.getElementById('lead-form');
      if(!form.reportValidity()){
        toast('Completa los campos obligatorios.');
        form.scrollIntoView({behavior:'smooth', block:'start'});
        return;
      }
      const d = {...formDataObject(form), ...utms()};
      try{
        const res = await fetch(ENDPOINT, {
          method:'POST',
          headers:{'Content-Type':'application/x-www-form-urlencoded;charset=UTF-8'},
          body: new URLSearchParams(d).toString()
        });
        const j = await res.json().catch(()=>({ok:false}));
        if(!j.ok){ console.warn('Script respondió:', j); }

        // Métricas
        window.dataLayer = window.dataLayer || [];
        window.dataLayer.push({event:'lead_submit', desarrollo:d.desarrollo});

        goWhatsApp(d);
      }catch(err){
        console.error(err);
        toast('Error al enviar. Intenta de nuevo.');
      }
    }

    document.getElementById('send-wa').addEventListener('click', e=>{ e.preventDefault(); submitLead(); });

    // Sticky (bloqueado)
    const sticky = document.getElementById('sticky-send');
    if(sticky){ sticky.addEventListener('click', e=>{ e.preventDefault(); toast('Llena tus datos para atenderte por WhatsApp.'); }); }

    // Aviso “Solicitar ficha”
    document.querySelectorAll('.ask-fill').forEach(a=>{
      a.addEventListener('click', e=>{
        e.preventDefault();
        toast('Déjanos tus datos y correo para enviarte la ficha.');
        document.getElementById('lead-form').scrollIntoView({behavior:'smooth', block:'start'});
      });
    });

    // Thumbs swap + Lightbox
    (function gallery(){
      // swap principal con thumbs
      document.getElementById('modelos').addEventListener('click', (e)=>{
        const t = e.target;
        if(t && t.dataset && t.dataset.target && t.dataset.src){
          const main = document.getElementById(t.dataset.target);
          if(main){ main.src = t.dataset.src; }
        }
      });

      // lightbox
      const lb = document.getElementById('lightbox');
      const img = document.getElementById('lbImg');
      const prev = document.getElementById('prevImg');
      const next = document.getElementById('nextImg');
      const close = document.getElementById('closeLb');

      let list = []; let idx = 0;
      const open = (arr,start=0)=>{ list=arr; idx=start; img.src=list[idx]; lb.style.display='flex'; lb.setAttribute('aria-hidden','false'); };
      const move = s=>{ if(!list.length) return; idx=(idx+s+list.length)%list.length; img.src=list[idx]; };
      const closeLb = ()=>{ lb.style.display='none'; lb.setAttribute('aria-hidden','true'); list=[]; };

      prev.addEventListener('click',()=>move(-1));
      next.addEventListener('click',()=>move(1));
      close.addEventListener('click',closeLb);
      lb.addEventListener('click',e=>{ if(e.target===lb) closeLb(); });
      document.addEventListener('keydown',e=>{
        if(lb.style.display==='flex'){
          if(e.key==='Escape') closeLb();
          if(e.key==='ArrowLeft') move(-1);
          if(e.key==='ArrowRight') move(1);
        }
      });

      document.querySelectorAll('.gallery-btn').forEach(btn=>{
        btn.addEventListener('click',e=>{
          e.preventDefault();
          const id = btn.dataset.gallery; // nardo | oliva
          const ul = document.getElementById('gallery-'+id);
          const urls = Array.from(ul.querySelectorAll('li')).map(li=>li.textContent.trim()).filter(Boolean);
          if(urls.length){ 
            // Métrica
            window.dataLayer = window.dataLayer || [];
            window.dataLayer.push({event:'gallery_open', model:id});
            open(urls,0);
          }
        });
      });

      // métrica WA click
      document.getElementById('send-wa').addEventListener('click',()=>{
        window.dataLayer = window.dataLayer || [];
        window.dataLayer.push({event:'wa_click', desarrollo:'Mirador del Bosque'});
      });
    })();
  </script>
</body>
</html>
